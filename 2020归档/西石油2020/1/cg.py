from gmpy2 import *
from Crypto.Util.number import *
f1 = 1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586

f2 = 565793545980404021917176171737381087790180558655380403750360123494827821905901954270664682

#q + q*p^3 =467962068718552895211162459665195309477537820950314984120501297653251626108029252766706321468050831941604717101473973050
#qp + q *p^2 = 565793545980404021917176171737381087790180558655380403750360123494827821905901954270664682
#q + q*p^3 =467962068718552895211162459665195309477537820950314984120501297653251626108029252766706321468050831941604717101473973050
#qp + q *p^2 = 565793545980404021917176171737381087790180558655380403750360123494827821905901954270664682
               
    

#q + q*p^3 =467962068718552895211162459665195309477537820950314984120501297653251626108029252766706321468050831941604717101473973050
#qp + q *p^2 = 565793545980404021917176171737381087790180558655380403750360123494827821905901954270664682
f1 = 1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586

f2 = 1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594


f3 = f1+3*f2
f4 = f2**3
f5 = f4//f3
a = 1
b = -f1
c = f5
delta = b**2-4*a*c
print(iroot(delta,2))
delta = iroot(delta, 2)[0]
p = (-b+delta)//(2*a)
print('root1',p)
q = (-b-delta)//(2*a)
print('root2',q)
print('q=',q)
q = 827089796345539312201480770649


f5 = f5//(q**2)
print(iroot(f5,3))
q = 827089796345539312201480770649
p = 1158310153629932205401500375817

c = 0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9e
e = 0x872a335

n = p*q
phi = (p-1)*(q-1)
d  = invert(e,phi)
print(long_to_bytes(pow(c,d,n)))
