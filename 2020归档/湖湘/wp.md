# lfsr

先将两段密文异或得到 k5 xor k4 的序列。

```python
ans = [203, 46, 23, 115, 12, 120, 173, 84, 210, 24, 76, 252, 174, 105, 74, 111, 102, 206, 54, 57, 153, 143, 234, 67, 80, 9, 140, 235, 75, 58, 187, 216, 112, 245, 250, 31, 38, 36, 97, 244, 183, 174, 201, 189, 55, 142, 124, 56, 44, 191, 42, 199, 6, 223, 101, 255, 235, 185, 248, 21, 254, 168, 134, 146, 124, 233, 65, 175, 17, 71, 91, 85, 155, 218, 227, 243, 157, 34, 218, 165, 172, 116, 78, 51, 249, 202, 29, 222, 170, 166, 209, 237, 246, 100, 27, 111, 183, 200, 154, 55, 232, 185, 96, 136, 132, 39, 224, 195, 192, 83, 182, 242, 253, 123, 21, 86, 40, 40, 205, 244, 98, 194, 179, 20, 237, 8, 49, 62, 253,
       188, 152, 10, 140, 115, 214, 64, 52, 190, 33, 73, 64, 232, 123, 200, 93, 186, 180, 29, 59, 147, 48, 113, 156, 81, 157, 254, 86, 184, 11, 219, 19, 122, 63, 159, 45, 18, 83, 106, 92, 168, 90, 30, 97, 78, 238, 242, 88, 129, 14, 101, 87, 35, 47, 126, 216, 142, 160, 223, 141, 45, 116, 241, 79, 44, 193, 233, 1, 13, 136, 213, 187, 4, 151, 84, 104, 65, 16, 109, 146, 80, 161, 68, 125, 205, 247, 203, 208, 41, 234, 171, 130, 150, 196, 92, 114, 5, 250, 95, 239, 1, 198, 229, 141, 162, 114, 199, 163, 37, 126, 204, 148, 178, 26, 159, 68, 228, 149, 89, 28, 204, 4, 96, 163, 215, 2, 182, 22, 164, 189, 102,
       18, 152, 108, 184, 132, 221, 37, 150, 54, 32, 8, 135, 236, 248, 22, 87, 186, 28, 108, 58, 99, 230, 85, 176, 137, 198, 165, 72, 70, 52, 117, 76, 17, 89, 158, 43, 63, 16, 133, 104, 228, 27, 217, 14, 113, 5, 9, 51, 41, 74, 149, 129, 211, 70, 238, 77, 213, 251, 170, 207, 39, 43, 197, 36, 127, 49, 201, 10, 3, 219, 172, 247, 69, 59, 135, 98, 91, 128, 6, 15, 229, 119, 180, 192, 24, 42, 94, 139, 25, 35, 220, 121, 162, 240, 2, 208, 211, 252, 25, 93, 31, 191, 169, 167, 178, 148, 60, 210, 181, 32, 160, 7, 66, 167, 158, 220, 57, 0, 105, 144, 48, 130, 240, 151, 214, 173, 50, 230, 239, 71, 153, 12, 225, 75, 46, 161, 202, 181, 231, 147, 143, 66, 50, 81, 249, 90, 207, 103, 226, 224, 131, 110, 11, 197, 177, 121, 79, 7, 245, 177, 131, 138, 82, 3, 194, 61, 255, 67, 128, 193, 60, 109, 119, 33, 15, 61, 73, 145, 133, 107, 243, 221, 231, 62, 227, 30, 155, 122, 20, 171, 117, 144, 212, 176, 138, 209, 99, 118, 118, 166, 110, 222, 88, 100, 127, 203, 46, 23, 115, 12, 120, 173, 84, 210, 24, 76, 252, 174, 105, 74, 111, 102, 206, 54, 57, 153, 143, 234, 67, 80, 9, 140, 235, 75, 58, 187, 216, 112, 245, 250, 31, 38, 36, 97, 244, 183, 174, 201, 189, 55, 142, 124, 56, 44, 191, 42, 199, 6, 223, 101, 255, 235,
       185, 248, 21, 254, 168, 134, 146, 124, 233, 65, 175, 17, 71, 91, 85, 155, 218, 227, 243, 157, 34, 218, 165, 172, 116, 78, 51, 249, 202, 29, 222, 170, 166, 209, 237, 246, 100, 27, 111, 183, 200, 154, 55, 232, 185, 96, 136, 132, 39, 224, 195, 192, 83, 182, 242, 253, 123, 21, 86, 40, 40, 205, 244, 98, 194, 179, 20, 237, 8, 49, 62, 253, 188, 152, 10, 140, 115, 214, 64, 52, 190, 33, 73, 64, 232, 123, 200, 93, 186, 180, 29, 59, 147, 48, 113, 156, 81, 157, 254, 86, 184, 11, 219, 19, 122, 63, 159, 45, 18, 83, 106, 92, 168, 90, 30, 97, 78, 238, 242, 88, 129, 14, 101, 87, 35, 47, 126, 216, 142, 160, 223, 141, 45, 116, 241, 79, 44, 193, 233, 1, 13, 136, 213, 187, 4, 151, 84, 104, 65, 16, 109, 146, 80, 161, 68, 125, 205, 247, 203, 208, 41, 234, 171, 130, 150, 196, 92, 114, 5, 250, 95, 239, 1, 198, 229, 141, 162, 114, 199, 163, 37, 126, 204, 148, 178, 26, 159, 68, 228, 149, 89, 28, 204, 4, 96,
       163, 215, 2, 182, 22, 164, 189, 102, 18, 152, 108, 184, 132, 221, 37, 150, 54, 32, 8, 135, 236, 248, 22, 87, 186, 28, 108, 58, 99, 230, 85, 176, 137, 198, 165, 72, 70, 52, 117, 76, 17, 89, 158, 43, 63, 16, 133, 104, 228, 27, 217, 14, 113, 5, 9, 51, 41, 74, 149, 129, 211, 70, 238, 77, 213, 251, 170, 207, 39, 43, 197, 36, 127, 49, 201, 10, 3, 219, 172, 247, 69, 59, 135, 98, 91, 128, 6, 15, 229, 119, 180, 192, 24]

```




分析一下可以发现前面的lfsr完全没有用，最后一个字符`{`是已知的，故可以求 k4 第14位和 k5 第 3 位，
```python
764
k4_ 14 ^ k5_ 20 = 104
779
k4_ 14 ^ k5_ 4 = 238
794
k4_ 14 ^ k5_ 19 = 219
809
k4_ 14 ^ k5_ 3 = 24
```


只需要找出与 k4[14] 异或的k5就能求出k5了

```python
for i in range(len(ans)):
    if i % len(k4) == 14:
        print(i)
        print('k4_',i% len(k4),'^','k5_',i%len(k5),'=',ans[i])
        l.append(i % len(k5))
        l2.append(ans[i] ^ 188)
key = [0 for i in range(33)]
for i in range(len(l)):
    key[l[i]] = l2[i]
```

然后求flag

```python
enc = b'p\xfd\x1ff\xcaB\xa5\xe6`\x87\xa8\x8ci\x855\x92O8P\xa5}^\xd8\xed\x1a\x88=c\xe0\x9f\xedq\xf8\xe1%\x7fX\xd2\xba\xbe\x03\xa8\x9a\x9c\x075\x98"\xca\xed\xa4C^\xc6.j\xec\xfa\x10\xa7\xd9\x01\x06\x87\x90f\xcc\xf6\x1b\x0c\xde\xcc,\xfb\xf0\xc74\x94\xcfj\x8ay\xd5\xd2`.@\xed\xc2\xd8!DSp\xf5\x12f\xf1\xf6#\x80\xbe\x16\xa8\xaeF\xd0\xd1\xd4\xad\xb9\xf7#\x16\x08\xb2[\x1a\x87\x8b\xa0\xfaEF\xbf\x86\x8b\x8c\x90\xa4\xd5\xfbcR\xe2W\x9c\n5\x8b\xcfQ"\xf2\x16\x10\xb2I\x1a\x88\x8b\x8cj\x16\xebp\xccS\xd2\x90\xa8|q\x05\xafq\xfa\xcaHE{\x1a\xba#\xfd\x17/\xb2L\x1a\x87\x8a\x90\xc9Dmp\xef\x0ef\xf2Z|S\x00R\xfc\x1c\x9d\n5\x84\xceS\xb0\xa4M_\xff\xb9\x1a\x8a\x1d\\\x98D\\p\xcb*f\xdcV\xd0\xd5Q\xec\x1a\xfa\xf0\x91\xa8\xd4\x8a\xca\x9c-\x17\x07\xb2_\xff\n\x8a\x83\xfb\xc2\x00\x10\x87\x83\xaeF\xf7#\xd4\xbe\'\xa9\x8a$IMp\x14\xe8\xc0\xa4z\xd1\xb2H\xe6e\x8b\xb0\xcf\xb1\x01<\x87\x88g\xc2Q|H\xbe9\xa9\xad\x9c#4\x8cl8I\x0c\x17$\xb3}\x1b\x94\x01:j7\x00;\x86\xbd\xd2i\xf6\x1a\xa4\'R\xf6?\x9c\x08\xe1\xd4\xab\xdd\x8f\xa4[_\xca/@\xed\xe86\xf7\x9c\x018i\x04\xc3\x90\xa8\xaa\x0c\xde\xf2\xa8\xba?\xf4\xd39\xce\\"\xfe\x16\x0cY/]\xed\xe9l\xce\xa5\x018o,g\xdb\xf7\x12\xdag\xb6=\xfa\xccHgk\xcfH\xbf\x18\x9e\xbd\xb3u\x8f\n$Hk\x0e\xd3\xa6i\xe1\x15=\x16}R]\xb3\xa8\x82\x9b\x0b4\x9a\xcf{\xc2\xa4V\xe8:\x93\x1a\x83\x8a\x97j\t\x82\x88\x86\x80f\xf6*\xa2\xd5\xbe\x08\xa9\x98\x9c#\xf8\\\xceV\xa7\xa5L\xae&/t\xec\xfb\xd9\x02Dnp\xe8Cf\xf0U}R4\x87a\xfb\xf0I_\xd4\xaa\xb4"\xca\x16\x18>/i}\t\x03\xc1\x84\x00!\x86\x93g\xed\xf7\x1d\xc3\xbf\x01c\x06KI[\xd5\x929g\xa4t\x87\xb2\\\x1b\x8d\x0b\xd9\x0bDp\xf5om\xe1\x16\x0e}|ZR\xc4\xfb\xf2H@\xd4\xa28\\c\x17&\x07\xc8\xda~\x8b\x88\x86DS\xeb\x87\x87f\xda\xf73\r\xcaS\xd9\xfa\xfaI`\xd5\x889^R\x97\xaeF\xf6\x1a\x92N\xd8*Er\xc3\x16\xe0)\x91\xba|_Q\x83\x00>;\xff5\x82\xceX"\xd7\x17\x08P\xae\x1a\xb1\x8a\x8f\xc9Ep\xa7\x86\x86g\xf6m|o\xbf\x1c\xa9\xa1\x9c+\xc9\x1e\xcfI#\xfc\x92^\xc1\xb8\x1b\xad\x8a\x9e\xceEu\xb8$\xe0\x0b\x90\x87}[\x0fS\xcab]\xd2\xaaU\xcfh"\xfc\xa2_\xdd/y<C\x05k\x18\x00\x1aw\x1e\x9cA\xf6\x0f\x80w\x83\xae\xb8\x9d\x0e\xdc\xd4\xaf9H\\\xaf\x9ey\xef\x1b\xb4.\xd99Dd\xa2\x87\xa7f\xc6\xf6\n\x0c\xc4R\xd7\xfa\xe4Hc\xd4\xa78Jc\x9c^\xca.u\xed\xfcak&\x8b\x92\x87\x88\xee\x90\x83\x90\x0c\xd9R\xcd\x08\x9c04\xb1\xceC"\xea\xe9^\xe3\xd4\x1a\x9a\x0c[\xfa\xc5\x97\xf5>\x15\xc71\x06\x8d\xac\x19\xa0\t\x0el\xe9\xc6%4\x9d\x80U\xe3\xfdF\x8d\xee\x17.+\x9b\xb3\xf0\x83w\x16\xd9'
for i in range(len(enc)):
    print(chr(key[i % len(key)] ^ enc[i]),end='')
```

最后一段就是flag

# 古典

网站爆破

# 简单密码

```python

s = '9894b94f1ba310e39412757481329907' # edit程序给的iv
s = bytes.fromhex(s)
iv = list(s)
s1 = b'name:ljaaa'
s2 = b'name:admin'

ans=[]
for i in range(len(s1)):
    ans.append(s1[i]^s2[i]^iv[i])
s=(ans+iv[len(s1):])

print(bytes(s).hex()) # 修改后的iv值
```

改iv绕输入，cbc常规