## 羊城杯2023


> 真-我来浅浅签个到
> 有点生疏了，一晚上只写了两个签到

### SigninCrypto

没注意reset了一次seed。。。

```python
from Crypto.Cipher import DES3
from Crypto.Util.number import *
'''
from hashlib import md5
from randcrack import RandCrack
from data import list1,list2

print(len(list2))
t=[]
for i in range(len(list2)):
    tmp2 = list2[i]
    x4 = tmp2&0xffff
    x2 = (tmp2&0xffff0000)>>16
    x3 = list1[i*2]
    x1 = list1[i*2+1]
    s1 = (x3<<16) +x4 
    s2 = (x1<<16)+x2
    
    t.append(s1)
    t.append(s2)
rc = RandCrack()
for i in t:
    rc.submit(i)
K2 = rc.predict_getrandbits(64)
print(hex(K2))

'''
enc = 'a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1'
enc = bytes.fromhex(enc)
r = b'\xfb\xc2'
hint1 = r * 8
xor = b'\xfb\xc2\xfb\xc2\xfb\xc2\xfb\xc2\x9f\xa3\x88\xa1\x8f\xa4\x9f\xa3'
K1 =bytes_to_long(hint1)^bytes_to_long(xor)

K1 =long_to_bytes(K1)


K2 = 0x77ab242d64a60e8e
K2 = long_to_bytes(K2)
# K2 =b'\x00\x00\x00\x00"Y\xcf3'
# 是的 iv高4字节和低4字节一样的
IV = b'GWHTGWHT'

for i in range(256):
    
    K3 = b'DASCTF{'+bytes([i])
    # print(K3)
    KEY = K1+K2+K3
    
    mode = DES3.MODE_CBC
    
    des3 = DES3.new(KEY, mode, IV)
    flag = des3.decrypt(enc)
    # print(flag)
    if(b'DAS' in flag):
        print(flag)
        
# b'DASCTF{8e5ee461-f4e1-4af2-8632-c9d62f4dc073}\x04\x04\x04\x04'
```

### Easy_3L

```python
from Crypto.Util.number import *


from Crypto.Util.number import *

'''
p = 25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351
h = 2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711
c = 20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287

def encrypt2(msg, p, h):
    s = getRandomNBitInteger(512)
    c = (s * h + msg) % p
    return c
v1 = vector(ZZ, [1, h])
v2 = vector(ZZ, [0, p])
m = matrix([v1,v2])
f, g = m.LLL()[0]
# print(f, g)
f = abs(f)
g = abs(g)
a = f*c % p % g
s3 = a * inverse_mod(f, g) % g
'''



S1 = 28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141
S2 = 1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888
S3 = 10700695166096094995375972320865971168959897437299342068124161538902514000691034236758289037664275323635047529647532200693311709347984126070052011571264606
S4 = 9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997
S5 = 9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736

s = [S1,S2,S3,S4,S5]
t = []
for i in range(1,len(s)):
    t.append(s[i]-s[i-1]) 
print(t)

all_n = []
for i in range(1,len(s)-3):
    print(i)
    all_n.append(GCD((t[i+1]*t[i-1]-t[i]*t[i]), (t[i+2]*t[i]-t[i+1]*t[i+1]))) 
print(all_n)
# for i in range(len(all_n)-1):
#     tmp = GCD(all_n[i+1],all_n[i])
#     print(isPrime(tmp),tmp)
# exit()
for n in all_n:
    n=abs(n)
    if n==1:
        continue
    a=(s[2]-s[1])*inverse((s[1]-s[0]),n)%n
    ani=inverse(a,n)
    b=(s[1]-a*s[0])%n
    print('a = ',a)
    print('b = ',b)



n = 12433235385460084327215142269091752668477278692416805859007828624838647815241707248797912107322868748847211061641608674422095027981318008221949510129177787
a = 1017579321905754831612145134014116183026524698685218523407174987842084260441
b = 1244547131344198183940330607549789182491018543684349414313485985685030480
# t1 = S2-S1
s0 = ((S1-b)*inverse(a,n)) % n

print(s0)
print(long_to_bytes(s0))
# b'DASCTF{NTRU_L0G_a6e_S1mpLe}'
```