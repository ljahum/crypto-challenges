#! /usr/bin/sage
from sage.all import *
from sage.groups.generic import bsgs
from Crypto.Util.number import *

p = 199577891335523667447918233627928226021
E = EllipticCurve(GF(p), [1, 0, 0, 6745936378050226004298256621352165803, 27906538695990793423441372910027591553])
G = E.gen(0)
P1 = (26333907222366222187416360421790100900 , 15685215723385060577747689361308893836 )
P2 = (53570576204982581657469369029969950113 , 25369349510945575560344119361348972982)
cipher = (154197284061586737858758103708592634427 , 79569265701802598850923391009373339175)
P2 = E(P2)
P1 = E(P1)
# key = bsgs(G,P2,(0,2^40),operation='+') cost 69s
# print(key)
key = 436370150383
cipher = E(cipher)
key1= key*P1
flag = cipher - key1
print(sum(flag.xy()) )
# 84533415420201939480674623196681036513