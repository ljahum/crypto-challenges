

# This file was *autogenerated* from the file /mnt/c/Users/16953/Desktop/西湖论健2021/c4.sage
from sage.all_cmdline import *   # import sage library

_sage_const_14495518778114167474739729576341382156051123900251385315392575992146230240828066524739423257556190872494534896452228092438352605852225378095479415234241693627152669918103952563488409911914041953318952912253561362567194578179472501501493157924863398240220185109065174034006355311931461868534004364824216437882806812943742779345240195697453192237683827475971869396838179928474061255963826670314529423654765979266920537437709646199083947096691336511187470294138975645079235614434241608503682768050458194018164657164385139231242474877973088095723057486163032066818139195163525630049209766910768854296354865892585740970447 = Integer(14495518778114167474739729576341382156051123900251385315392575992146230240828066524739423257556190872494534896452228092438352605852225378095479415234241693627152669918103952563488409911914041953318952912253561362567194578179472501501493157924863398240220185109065174034006355311931461868534004364824216437882806812943742779345240195697453192237683827475971869396838179928474061255963826670314529423654765979266920537437709646199083947096691336511187470294138975645079235614434241608503682768050458194018164657164385139231242474877973088095723057486163032066818139195163525630049209766910768854296354865892585740970447); _sage_const_5224916291470742030008724556070921953804760395725636469618472671577145713228126864423171936934802806640961215859932078534505232949604181834721295250254463922355708077815184231656453112619039521163542468401109227011117584891474241150651863577873706367965516360560164799285494209972159348971506334913882303575722911404510289385880586250115426145692625859648854087627296699765370721071986748465615291505183060006766189631599504285990540707708240734944647555461713401597607618240408029073128480865050167282132686140494347149355351838185211530254855959431220079990115500043861061110316339469581514060438627780122610235853 = Integer(5224916291470742030008724556070921953804760395725636469618472671577145713228126864423171936934802806640961215859932078534505232949604181834721295250254463922355708077815184231656453112619039521163542468401109227011117584891474241150651863577873706367965516360560164799285494209972159348971506334913882303575722911404510289385880586250115426145692625859648854087627296699765370721071986748465615291505183060006766189631599504285990540707708240734944647555461713401597607618240408029073128480865050167282132686140494347149355351838185211530254855959431220079990115500043861061110316339469581514060438627780122610235853); _sage_const_2569677939868514683924494340939441534358457517659289043154401136897301258038538770619698706966937234521264257154524351859775691481649637087968398061121772452302994683642213940948449325636316736249608244616270084650920600397549289490619940688561289014649300854796165818319557281361622115220398819986703604120249854968400968801565233682916911748047214697573021445367159107329154676877301700192709021948573801478987587259591964376266070021672352915762694782398139346797260767651494293859222004059863316432420851120909716989390973370054598132609008747371455117599823498974119065650806633997003839967581263951090286860709 = Integer(2569677939868514683924494340939441534358457517659289043154401136897301258038538770619698706966937234521264257154524351859775691481649637087968398061121772452302994683642213940948449325636316736249608244616270084650920600397549289490619940688561289014649300854796165818319557281361622115220398819986703604120249854968400968801565233682916911748047214697573021445367159107329154676877301700192709021948573801478987587259591964376266070021672352915762694782398139346797260767651494293859222004059863316432420851120909716989390973370054598132609008747371455117599823498974119065650806633997003839967581263951090286860709); _sage_const_1932966020782159853310616585673822797876248402843135681015920016384628422106409788504851558857583122919762584316503041924732316806057652427775196280183950253709890647929583560995828824230667599175362187671643847382175120936138356485282814195493049001973717305878215210432665720064263146504438410551720501445277145039993364478607396243433737059026243552254722087665711664419859511855651214902480132981511106274152061245701279137907250432357628349482375449466624835913683219390021707080094271548450355080654766419498207795335357015901536738958572810147458973485219764245257129862392319715795691990048307818621716068829 = Integer(1932966020782159853310616585673822797876248402843135681015920016384628422106409788504851558857583122919762584316503041924732316806057652427775196280183950253709890647929583560995828824230667599175362187671643847382175120936138356485282814195493049001973717305878215210432665720064263146504438410551720501445277145039993364478607396243433737059026243552254722087665711664419859511855651214902480132981511106274152061245701279137907250432357628349482375449466624835913683219390021707080094271548450355080654766419498207795335357015901536738958572810147458973485219764245257129862392319715795691990048307818621716068829); _sage_const_65537 = Integer(65537); _sage_const_1 = Integer(1); _sage_const_0 = Integer(0); _sage_const_2 = Integer(2); _sage_const_3 = Integer(3); _sage_const_0p355 = RealNumber('0.355')#! /usr/bin/sage
from sage.all import *
from sage.groups.generic import bsgs
from Crypto.Util.number import *
n = _sage_const_14495518778114167474739729576341382156051123900251385315392575992146230240828066524739423257556190872494534896452228092438352605852225378095479415234241693627152669918103952563488409911914041953318952912253561362567194578179472501501493157924863398240220185109065174034006355311931461868534004364824216437882806812943742779345240195697453192237683827475971869396838179928474061255963826670314529423654765979266920537437709646199083947096691336511187470294138975645079235614434241608503682768050458194018164657164385139231242474877973088095723057486163032066818139195163525630049209766910768854296354865892585740970447 
e1= _sage_const_5224916291470742030008724556070921953804760395725636469618472671577145713228126864423171936934802806640961215859932078534505232949604181834721295250254463922355708077815184231656453112619039521163542468401109227011117584891474241150651863577873706367965516360560164799285494209972159348971506334913882303575722911404510289385880586250115426145692625859648854087627296699765370721071986748465615291505183060006766189631599504285990540707708240734944647555461713401597607618240408029073128480865050167282132686140494347149355351838185211530254855959431220079990115500043861061110316339469581514060438627780122610235853 
e2 = _sage_const_2569677939868514683924494340939441534358457517659289043154401136897301258038538770619698706966937234521264257154524351859775691481649637087968398061121772452302994683642213940948449325636316736249608244616270084650920600397549289490619940688561289014649300854796165818319557281361622115220398819986703604120249854968400968801565233682916911748047214697573021445367159107329154676877301700192709021948573801478987587259591964376266070021672352915762694782398139346797260767651494293859222004059863316432420851120909716989390973370054598132609008747371455117599823498974119065650806633997003839967581263951090286860709 
e3  = _sage_const_1932966020782159853310616585673822797876248402843135681015920016384628422106409788504851558857583122919762584316503041924732316806057652427775196280183950253709890647929583560995828824230667599175362187671643847382175120936138356485282814195493049001973717305878215210432665720064263146504438410551720501445277145039993364478607396243433737059026243552254722087665711664419859511855651214902480132981511106274152061245701279137907250432357628349482375449466624835913683219390021707080094271548450355080654766419498207795335357015901536738958572810147458973485219764245257129862392319715795691990048307818621716068829 
e = _sage_const_65537 
B = Matrix([
    [_sage_const_1 , -N,   _sage_const_0 ,    N**_sage_const_2 ,     _sage_const_0 ,          _sage_const_0 ,     _sage_const_0 ,      -N**_sage_const_3 ],
    [_sage_const_0 , e1, -e1,    -e1*N,   -e1,        _sage_const_0 ,  e1*N,      e1*N**_sage_const_2 ],
    [_sage_const_0 ,  _sage_const_0 ,  e2,    -e2*N,   _sage_const_0 ,       e2*N,     _sage_const_0 ,      e2*N**_sage_const_2 ],
    [_sage_const_0 ,  _sage_const_0 ,   _sage_const_0 ,    e1*e2,   _sage_const_0 ,       -e1*e2,-e1*e2,    -e1*e2*N],
    [_sage_const_0 ,  _sage_const_0 ,   _sage_const_0 ,    _sage_const_0 ,      e3,       -e3*N, -e3*N,     e3*N**_sage_const_2 ],
    [_sage_const_0 ,  _sage_const_0 ,   _sage_const_0 ,    _sage_const_0 ,       _sage_const_0 ,       e1*e3,    _sage_const_0 ,     -e1*e3*N],
    [_sage_const_0 ,  _sage_const_0 ,   _sage_const_0 ,    _sage_const_0 ,       _sage_const_0 ,         _sage_const_0 ,  e2*e3,     -e2*e3*N],
    [_sage_const_0 ,  _sage_const_0 ,   _sage_const_0 ,    _sage_const_0 ,       _sage_const_0 ,         _sage_const_0 ,      _sage_const_0 ,     e1*e2*e3],
])

x = _sage_const_0p355 
r=_sage_const_2 
D = Matrix([
    [N**(_sage_const_3 *(_sage_const_1 -_sage_const_1 /r)),            _sage_const_0 ,                   _sage_const_0 ,                           _sage_const_0 ,              _sage_const_0 ,              _sage_const_0 ,          _sage_const_0 ,            _sage_const_0 ],
    [_sage_const_0 ,             int(N**(_sage_const_2 *(_sage_const_1 -_sage_const_1 /r))),             _sage_const_0 ,                           _sage_const_0 ,              _sage_const_0 ,              _sage_const_0 ,          _sage_const_0 ,            _sage_const_0 ],
    [_sage_const_0 ,                         _sage_const_0 ,             int(N**(x+_sage_const_3 *(_sage_const_1 -_sage_const_1 /r))),             _sage_const_0 ,              _sage_const_0 ,              _sage_const_0 ,          _sage_const_0 ,            _sage_const_0 ],
    [_sage_const_0 ,                         _sage_const_0 ,                  _sage_const_0 ,                      N**(_sage_const_1 -_sage_const_1 /r),          _sage_const_0 ,              _sage_const_0 ,          _sage_const_0 ,            _sage_const_0 ],
    [_sage_const_0 ,                         _sage_const_0 ,                  _sage_const_0 ,                           _sage_const_0 ,      N**(x+_sage_const_3 *(_sage_const_1 -_sage_const_1 /r)),        _sage_const_0 ,          _sage_const_0 ,            _sage_const_0 ],
    [_sage_const_0 ,                         _sage_const_0 ,                  _sage_const_0 ,                           _sage_const_0 ,              _sage_const_0 ,     N**(x+_sage_const_2 *(_sage_const_1 -_sage_const_1 /r)),    _sage_const_0 ,            _sage_const_0 ],
    [_sage_const_0 ,                         _sage_const_0 ,                  _sage_const_0 ,                           _sage_const_0 ,              _sage_const_0 ,             _sage_const_0 ,      N**(x+_sage_const_2 *(_sage_const_1 -_sage_const_1 /r)),    _sage_const_0 ],
    [_sage_const_0 ,                         _sage_const_0 ,                  _sage_const_0 ,                           _sage_const_0 ,              _sage_const_0 ,             _sage_const_0 ,          _sage_const_0 ,              _sage_const_1 ]
])

res = B*D
lll = res.LLL()
y =  lll[_sage_const_0 ]
inv = res.inverse()
x = y*inv
phi = (e1*(x[_sage_const_1 ]))//x[_sage_const_0 ]
phi = int(phi)
d= inverse(e,phi)

