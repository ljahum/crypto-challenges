from Crypto.Util.number import (
    bytes_to_long,
    getPrime,
    long_to_bytes,
    getRandomNBitInteger,
)
from icecream import *
import random
import hashlib
from math import gcd
n = 129928426203781188899307370647664586452710611301460165598612582591296318311338532722392694995141763369749507832197938961741130897429800514250578479822167870317124217392812427126563904356287575881096879436559243128394189959355308569430980572662733416690318888780659785069234098610099238179050980834472177902773
g = 129928426203781188899307370647664586452710611301460165598612582591296318311338532722392694995141763369749507832197938961741130897429800514250578479822167870317124217392812427126563904356287575881096879436559243128394189959355308569430980572662733416690318888780659785069234098610099238179050980834472177902774
def enc(n, g, m):
    while 1:
        r = random.randint(2, n - 1)
        if gcd(r, n) == 1:
            break
    c = (pow(g, m, n ** 2) * pow(r, n, n ** 2)) % (n ** 2)
    return c
m = 123123123123
c = enc(n,g,m)
print(c)
# 339701687201081654160471541192059164907007609724562952804876656631760200244820803797370935664576694964247195938774920592161479446403254720463446420830984066470063899719552286622417975921891370172852043533795789382739482296487267438591700325398440473568173355998765153395798493428336873570956074001962635179576794442701157180782216181519858711937010962083834906825026362257660845986406320600445012786012766157560486456884845048883770647563938467675193998449069419354575145196076617393329260929355466697439205491484462858186112710010097387355383995912190440375251283753840213656404289985752381106512009550283881833938
'''
x1 787
x 929
'''
m1 =  787
m2 =  929
x1 = enc(n,g,787)
c1 = 154209746526830224040646299339784785271293555326810420110753474439838844269833678167837658812111198104145288969230687893523869926193911176565742252006512394898093186529531136303055490914698362578615655563496320476302258692507046438898690503970509094462252376672461816966379762759585555721586350671360357814972857148926768360253462566360724834674906471483881064914331777693239246592377478187068921341794550313812921275473830893533237540374673448395240686068527831281987355870315721237636705867584850008509977649626539307338444137217763478269910996527942073993531834444846633351760749822062092966398212216218745424541

c1x1 = pow(c1,m1,n**2)
ic(c1x1)
tmp = 126011242419
k = (tmp)//(m1*m2*m1)
print(k)