

# This file was *autogenerated* from the file test.sage
from sage.all_cmdline import *   # import sage library

_sage_const_115483338707853323510117244601663937653032657454816581880428779391136584508645415322441921678179684904267659942318581245589538093236558206867210468172871004098796706517288570963560499418427771831765342801956281881820593084352360716457591198748797415842971188690055630073433785996545367137242661591939632740177 = Integer(115483338707853323510117244601663937653032657454816581880428779391136584508645415322441921678179684904267659942318581245589538093236558206867210468172871004098796706517288570963560499418427771831765342801956281881820593084352360716457591198748797415842971188690055630073433785996545367137242661591939632740177); _sage_const_57942961120648999071495995119939754708884253716257622598699627649519120883383654560602196191747110519111036450217116739928381611061803307053632035548944075112790103258912149703053932492832060534126356062378027983000713091223894604748395826345780826674822582205573649323340945351657354960324397873669889767611 = Integer(57942961120648999071495995119939754708884253716257622598699627649519120883383654560602196191747110519111036450217116739928381611061803307053632035548944075112790103258912149703053932492832060534126356062378027983000713091223894604748395826345780826674822582205573649323340945351657354960324397873669889767611); _sage_const_53622548101803784449246949981043962044702821559359430270342163843702543781580388956841660273746825211912789196955019345268896290156568895362182295889379787233440464948232717888315385094207004043907898658611926470834448875571292174245716821120409044389816082878077188546182422805778560826667364235348059795229 = Integer(53622548101803784449246949981043962044702821559359430270342163843702543781580388956841660273746825211912789196955019345268896290156568895362182295889379787233440464948232717888315385094207004043907898658611926470834448875571292174245716821120409044389816082878077188546182422805778560826667364235348059795229); _sage_const_37629174280947918845570975617525141920002123382327456934545962737176558640617579710289304146119507880547361939594011152968663070025066085778798378563965349218834887746411017240322083056673687330052590220772859205859051875687741541958997904176801239206348298021023694604932588913541173039972303193792987583003 = Integer(37629174280947918845570975617525141920002123382327456934545962737176558640617579710289304146119507880547361939594011152968663070025066085778798378563965349218834887746411017240322083056673687330052590220772859205859051875687741541958997904176801239206348298021023694604932588913541173039972303193792987583003); _sage_const_51861394323132582263685584977796608641129485967610029542263453128833142621927008505594685713111162217651119546991411861320042282788909858323941435593508384080858965324662410947546608051702238057613339996124961723578887443100478753831786550701578678090466528863014222331341645240511640398819027209200809466160 = Integer(51861394323132582263685584977796608641129485967610029542263453128833142621927008505594685713111162217651119546991411861320042282788909858323941435593508384080858965324662410947546608051702238057613339996124961723578887443100478753831786550701578678090466528863014222331341645240511640398819027209200809466160); _sage_const_53200507591144017820710284362261363695745231005527161900426580605551005076410241969689161754211964469126847594337121140420040532547631617290907291418063708630323838133357597795892690304405706577096504918510233628396424543417886828387510407109281423448827267022542075484645277275676556239547911837897827866040 = Integer(53200507591144017820710284362261363695745231005527161900426580605551005076410241969689161754211964469126847594337121140420040532547631617290907291418063708630323838133357597795892690304405706577096504918510233628396424543417886828387510407109281423448827267022542075484645277275676556239547911837897827866040); _sage_const_3 = Integer(3); _sage_const_0 = Integer(0); _sage_const_1 = Integer(1); _sage_const_2 = Integer(2); _sage_const_4 = Integer(4)
from icecream import *

from Crypto.Util.number import *

# d = 1378763197174295370919668049073434860171952335239280833251936937231882181821860459047054203
# n1 = 130977872949776463003322478534744453121235330488181934586087835375189884865037628584744281882819923628071236962095041381620780036195826813000061274217617950593008239815240026751349690586875648088714973705965116560759378310003875936556456754809677068916263669979521272295522593773763784637452213033527403965811
# e1 = 32378567173518871820444207653929377598613976508379673302754957708212238668965542792951360208223392362560917967889448723059651189897255908248591538548205636520695762174168130859513548604461524357064071984102472925848074562658370499829828168618739846916725013872538792951023174029919320916633098022544903799907
# n2 = 151417976596674004335107055412677646515824029502844236138144797088869412093391523368443145339089454320485252185573597274631900402179691901748649130903498004993306914417848026319822881204295676374013812703074253000733722551381779278120573815373217550369301649577519219287224439362103150495425207202418383615901
# e2 = 13246094946232866639964874111166269381526312685309952560740325524299303289545628799430935543583274004477951439343745720207763202593935289360122020520527425339376962786272543174346645947873199796383993069835861026182562337355394517062485268508719417949867494857717171299080008521837108130329292984984763112467

# d = 1848787175841919277261075065346237835258975716191602092526829646876694617997750121480943401
# n1 = 100942437939976370122703644189159178045949478410993435133331363133671960617716218282972609956366901718921496016863888716733075479448761763006349113446924050613598365858047705458117401941750341533345395567751258399691558243404987648155539681050874949410827774174963518448258863702371538743294239650498524501643
# e1 = 20286879791748450114116707245111653335494435843592136969170729323482938595644810515841955554010153222025288972827894920931087163428936637446280116293142514960477779173637411068289663551014804511190894206480300870440948002308853909900798525416323425654009517096780291627617813451590098641242653075033382815729
# n2 = 54381670377367686478140897004069141855864567727520511778149054862687266983554621023569011588321698869647377863701887230675620244838252650066904816666078436995645803906810472540020615731771334057656907322446263680799797266396961084398822960261321804045142838803430031344187118684109552934084306954130885683781
# e2 = 23782549057418466876443111973482876248093012373885011162181598071261032524456336564392278637393287726752526750957948499830038992317693364419817868377765057006903777877357619549918805051580518955576851965013419591259495179104997852370352001360659039716925582827416248921988133266534850052023859414534845065601
# c1 = 55286039916354432405217733161715367471726440233048307703617799925744890414035226441079562259742849047588061016349731196234594553880623731637661726960189737675277235434073561613829833770037713426817601468119385594789737844071181351922807840566268074990612925909523976063966411908357079200998257511950201090100
# c2 = 17715633994379255662321575356787543222220724663006039925374743597827940484974113997740878864258658273061165195028809496994892801655179786471112851680846266144813944630762963724933391668706234868614794853730808135981643495745697762771785675252546108769298050455155257700417946582653112525228355055885245553548
n1 = _sage_const_115483338707853323510117244601663937653032657454816581880428779391136584508645415322441921678179684904267659942318581245589538093236558206867210468172871004098796706517288570963560499418427771831765342801956281881820593084352360716457591198748797415842971188690055630073433785996545367137242661591939632740177 
e1 = _sage_const_57942961120648999071495995119939754708884253716257622598699627649519120883383654560602196191747110519111036450217116739928381611061803307053632035548944075112790103258912149703053932492832060534126356062378027983000713091223894604748395826345780826674822582205573649323340945351657354960324397873669889767611 
n2 = _sage_const_53622548101803784449246949981043962044702821559359430270342163843702543781580388956841660273746825211912789196955019345268896290156568895362182295889379787233440464948232717888315385094207004043907898658611926470834448875571292174245716821120409044389816082878077188546182422805778560826667364235348059795229 
e2 = _sage_const_37629174280947918845570975617525141920002123382327456934545962737176558640617579710289304146119507880547361939594011152968663070025066085778798378563965349218834887746411017240322083056673687330052590220772859205859051875687741541958997904176801239206348298021023694604932588913541173039972303193792987583003 
c1 = _sage_const_51861394323132582263685584977796608641129485967610029542263453128833142621927008505594685713111162217651119546991411861320042282788909858323941435593508384080858965324662410947546608051702238057613339996124961723578887443100478753831786550701578678090466528863014222331341645240511640398819027209200809466160 
c2 = _sage_const_53200507591144017820710284362261363695745231005527161900426580605551005076410241969689161754211964469126847594337121140420040532547631617290907291418063708630323838133357597795892690304405706577096504918510233628396424543417886828387510407109281423448827267022542075484645277275676556239547911837897827866040 




M = matrix(ZZ, _sage_const_3 , _sage_const_3 )

M = isqrt(max(n1, n2))
# M = 10704523536419069847275584063070587220303695362157261593514212717132031073368631333467085885236049291630529090309346493924305038011673707087598638071644281
print(M)
B = matrix(ZZ, [
           [M, e1, e2],
           [_sage_const_0 , -n1, _sage_const_0 ],
           [_sage_const_0 , _sage_const_0 , -n2],
           ])
BL = B.LLL()

temp = int(BL[_sage_const_0 , _sage_const_0 ])
if temp < _sage_const_0 :
    temp *= -_sage_const_1 
d = int(temp//M)
ic(int(temp//M), int(temp//M) - d)
t1 = -int(BL[_sage_const_0 , _sage_const_1 ]-e1*d)
ic(t1)
ic(t1%n1)
k1 = t1//n1

tmp = BL[_sage_const_0 , _sage_const_1 ]-_sage_const_1 
ic(tmp%k1)
ic(tmp//k1)
a = tmp//k1 - _sage_const_1 
n = n1

q = ((a+isqrt(a**_sage_const_2 -_sage_const_4 *n))//_sage_const_2 )
ic(q)
ic(n % q)
p = n//q
d = inverse(e1,(p-_sage_const_1 )*(q-_sage_const_1 ))
# c1 = 77331957632713152087886392813117468156126118935265781990019775924353889995824910805797219503109010569079750440698829234081030187653686142410864741337559424382421986194719973263696515896684885728079607143165197289976120260778135568837928399082445067684660892107087624493229931849909112677436248241067218490538
m = pow(c1,d,n1)
print(long_to_bytes(m) )


