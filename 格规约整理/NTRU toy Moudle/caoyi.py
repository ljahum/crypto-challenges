from gmpy2 import iroot, sqrt
from Crypto.Util.number import *
from icecream import *


n = 69804507328197961654128697510310109608046244030437362639637009184945533884294737870524186521509776189989451383438084507903660182212556466321058025788319193059894825570785105388123718921480698851551024108844782091117408753782599961943040695892323702361910107399806150571836786642746371968124465646209366215361
b = 65473938578022920848984901484624361251869406821863616908777213906525858437236185832214198627510663632409869363143982594947164139220013904654196960829350642413348771918422220404777505345053202159200378935309593802916875681436442734667249049535670986673774487031873808527230023029662915806344014429627710399196

c = 64666354938466194052720591810783769030566504653409465121173331362654665231573809234913985758725048071311571549777481776826624728742086174609897160897118750243192791021577348181130302572185911750797457793921069473730039225991755755340927506766395262125949939309337338656431876690470938261261164556850871338570

q = n
h = inverse_mod(b,n)
e = (inverse_mod(b, n)*c) % n

def gaussian(v1, v2):
    while True:
        if sqrt(v2[0]**2+v2[1]**2) < sqrt(v1[0]**2+v1[1]**2):
            v1, v2 = v2, v1
        m = int((v1[0]*v2[0]+v1[1]*v2[1])/(v1[0]**2+v1[1]**2))
        if m == 0:
            return (v1, v2)
        v2 = [v2[0]-m*v1[0], v2[1]-m*v1[1]]


s1, s2 = gaussian([1, h], [0, q])
f, g = s1[0], s1[1]
ic(f,g)

A = (f*e)%q
B = (A*inverse(f,g))%g
m = B
print(m)
print(len(bin(m)))
'''
m = 1443196433665198993523767955999914306340685280074176763368664154046190114522740462693673796369343624804755255132219524269
    607103751832889923345903055904026001399228494690341244187444772583567596158656799144620836619693630853705076970848480659911748433874329935696392602341323

ic| f: 1713445372381598798371474192888117061495093026732705918930416905660019351856535492102699621519215691485573847778780510006598563574113195652956010988026457
    g: 4401261541845145165867525601623379107498906810368800829619426493500357058790370762574139577787467171819481517303501800050622684320448155762442142852226212
'''
