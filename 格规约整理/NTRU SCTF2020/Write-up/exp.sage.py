

# This file was *autogenerated* from the file exp.sage
from sage.all_cmdline import *   # import sage library

_sage_const_109 = Integer(109); _sage_const_2048 = Integer(2048); _sage_const_3 = Integer(3); _sage_const_510 = Integer(510); _sage_const_108 = Integer(108); _sage_const_840 = Integer(840); _sage_const_107 = Integer(107); _sage_const_926 = Integer(926); _sage_const_106 = Integer(106); _sage_const_717 = Integer(717); _sage_const_105 = Integer(105); _sage_const_374 = Integer(374); _sage_const_104 = Integer(104); _sage_const_986 = Integer(986); _sage_const_103 = Integer(103); _sage_const_488 = Integer(488); _sage_const_102 = Integer(102); _sage_const_119 = Integer(119); _sage_const_101 = Integer(101); _sage_const_247 = Integer(247); _sage_const_100 = Integer(100); _sage_const_34 = Integer(34); _sage_const_99 = Integer(99); _sage_const_751 = Integer(751); _sage_const_98 = Integer(98); _sage_const_44 = Integer(44); _sage_const_97 = Integer(97); _sage_const_257 = Integer(257); _sage_const_96 = Integer(96); _sage_const_749 = Integer(749); _sage_const_95 = Integer(95); _sage_const_648 = Integer(648); _sage_const_94 = Integer(94); _sage_const_280 = Integer(280); _sage_const_93 = Integer(93); _sage_const_585 = Integer(585); _sage_const_92 = Integer(92); _sage_const_347 = Integer(347); _sage_const_91 = Integer(91); _sage_const_357 = Integer(357); _sage_const_90 = Integer(90); _sage_const_451 = Integer(451); _sage_const_89 = Integer(89); _sage_const_15 = Integer(15); _sage_const_88 = Integer(88); _sage_const_638 = Integer(638); _sage_const_87 = Integer(87); _sage_const_624 = Integer(624); _sage_const_86 = Integer(86); _sage_const_458 = Integer(458); _sage_const_85 = Integer(85); _sage_const_216 = Integer(216); _sage_const_84 = Integer(84); _sage_const_36 = Integer(36); _sage_const_83 = Integer(83); _sage_const_199 = Integer(199); _sage_const_82 = Integer(82); _sage_const_655 = Integer(655); _sage_const_81 = Integer(81); _sage_const_258 = Integer(258); _sage_const_80 = Integer(80); _sage_const_845 = Integer(845); _sage_const_79 = Integer(79); _sage_const_490 = Integer(490); _sage_const_78 = Integer(78); _sage_const_272 = Integer(272); _sage_const_77 = Integer(77); _sage_const_279 = Integer(279); _sage_const_76 = Integer(76); _sage_const_75 = Integer(75); _sage_const_580 = Integer(580); _sage_const_74 = Integer(74); _sage_const_461 = Integer(461); _sage_const_73 = Integer(73); _sage_const_614 = Integer(614); _sage_const_72 = Integer(72); _sage_const_171 = Integer(171); _sage_const_71 = Integer(71); _sage_const_1012 = Integer(1012); _sage_const_70 = Integer(70); _sage_const_69 = Integer(69); _sage_const_579 = Integer(579); _sage_const_68 = Integer(68); _sage_const_290 = Integer(290); _sage_const_67 = Integer(67); _sage_const_597 = Integer(597); _sage_const_66 = Integer(66); _sage_const_841 = Integer(841); _sage_const_65 = Integer(65); _sage_const_35 = Integer(35); _sage_const_64 = Integer(64); _sage_const_545 = Integer(545); _sage_const_63 = Integer(63); _sage_const_575 = Integer(575); _sage_const_62 = Integer(62); _sage_const_665 = Integer(665); _sage_const_61 = Integer(61); _sage_const_304 = Integer(304); _sage_const_60 = Integer(60); _sage_const_900 = Integer(900); _sage_const_59 = Integer(59); _sage_const_428 = Integer(428); _sage_const_58 = Integer(58); _sage_const_992 = Integer(992); _sage_const_57 = Integer(57); _sage_const_241 = Integer(241); _sage_const_56 = Integer(56); _sage_const_953 = Integer(953); _sage_const_55 = Integer(55); _sage_const_784 = Integer(784); _sage_const_54 = Integer(54); _sage_const_730 = Integer(730); _sage_const_53 = Integer(53); _sage_const_317 = Integer(317); _sage_const_52 = Integer(52); _sage_const_51 = Integer(51); _sage_const_180 = Integer(180); _sage_const_50 = Integer(50); _sage_const_881 = Integer(881); _sage_const_49 = Integer(49); _sage_const_943 = Integer(943); _sage_const_48 = Integer(48); _sage_const_413 = Integer(413); _sage_const_47 = Integer(47); _sage_const_898 = Integer(898); _sage_const_46 = Integer(46); _sage_const_453 = Integer(453); _sage_const_45 = Integer(45); _sage_const_407 = Integer(407); _sage_const_153 = Integer(153); _sage_const_43 = Integer(43); _sage_const_932 = Integer(932); _sage_const_42 = Integer(42); _sage_const_262 = Integer(262); _sage_const_41 = Integer(41); _sage_const_874 = Integer(874); _sage_const_40 = Integer(40); _sage_const_7 = Integer(7); _sage_const_39 = Integer(39); _sage_const_364 = Integer(364); _sage_const_38 = Integer(38); _sage_const_37 = Integer(37); _sage_const_130 = Integer(130); _sage_const_942 = Integer(942); _sage_const_890 = Integer(890); _sage_const_33 = Integer(33); _sage_const_558 = Integer(558); _sage_const_32 = Integer(32); _sage_const_791 = Integer(791); _sage_const_31 = Integer(31); _sage_const_654 = Integer(654); _sage_const_30 = Integer(30); _sage_const_733 = Integer(733); _sage_const_29 = Integer(29); _sage_const_28 = Integer(28); _sage_const_182 = Integer(182); _sage_const_27 = Integer(27); _sage_const_644 = Integer(644); _sage_const_26 = Integer(26); _sage_const_18 = Integer(18); _sage_const_25 = Integer(25); _sage_const_776 = Integer(776); _sage_const_24 = Integer(24); _sage_const_23 = Integer(23); _sage_const_675 = Integer(675); _sage_const_22 = Integer(22); _sage_const_741 = Integer(741); _sage_const_21 = Integer(21); _sage_const_352 = Integer(352); _sage_const_20 = Integer(20); _sage_const_143 = Integer(143); _sage_const_19 = Integer(19); _sage_const_351 = Integer(351); _sage_const_158 = Integer(158); _sage_const_17 = Integer(17); _sage_const_671 = Integer(671); _sage_const_16 = Integer(16); _sage_const_609 = Integer(609); _sage_const_14 = Integer(14); _sage_const_811 = Integer(811); _sage_const_13 = Integer(13); _sage_const_674 = Integer(674); _sage_const_12 = Integer(12); _sage_const_595 = Integer(595); _sage_const_11 = Integer(11); _sage_const_1005 = Integer(1005); _sage_const_10 = Integer(10); _sage_const_855 = Integer(855); _sage_const_9 = Integer(9); _sage_const_831 = Integer(831); _sage_const_8 = Integer(8); _sage_const_768 = Integer(768); _sage_const_133 = Integer(133); _sage_const_6 = Integer(6); _sage_const_436 = Integer(436); _sage_const_5 = Integer(5); _sage_const_1016 = Integer(1016); _sage_const_4 = Integer(4); _sage_const_403 = Integer(403); _sage_const_904 = Integer(904); _sage_const_2 = Integer(2); _sage_const_248 = Integer(248); _sage_const_380 = Integer(380); _sage_const_657 = Integer(657); _sage_const_988 = Integer(988); _sage_const_219 = Integer(219); _sage_const_167 = Integer(167); _sage_const_473 = Integer(473); _sage_const_1014 = Integer(1014); _sage_const_846 = Integer(846); _sage_const_604 = Integer(604); _sage_const_649 = Integer(649); _sage_const_689 = Integer(689); _sage_const_439 = Integer(439); _sage_const_968 = Integer(968); _sage_const_834 = Integer(834); _sage_const_967 = Integer(967); _sage_const_496 = Integer(496); _sage_const_883 = Integer(883); _sage_const_971 = Integer(971); _sage_const_242 = Integer(242); _sage_const_956 = Integer(956); _sage_const_832 = Integer(832); _sage_const_587 = Integer(587); _sage_const_525 = Integer(525); _sage_const_464 = Integer(464); _sage_const_661 = Integer(661); _sage_const_940 = Integer(940); _sage_const_277 = Integer(277); _sage_const_899 = Integer(899); _sage_const_390 = Integer(390); _sage_const_441 = Integer(441); _sage_const_246 = Integer(246); _sage_const_267 = Integer(267); _sage_const_395 = Integer(395); _sage_const_185 = Integer(185); _sage_const_221 = Integer(221); _sage_const_466 = Integer(466); _sage_const_249 = Integer(249); _sage_const_813 = Integer(813); _sage_const_116 = Integer(116); _sage_const_151 = Integer(151); _sage_const_194 = Integer(194); _sage_const_367 = Integer(367); _sage_const_758 = Integer(758); _sage_const_460 = Integer(460); _sage_const_162 = Integer(162); _sage_const_837 = Integer(837); _sage_const_903 = Integer(903); _sage_const_896 = Integer(896); _sage_const_747 = Integer(747); _sage_const_410 = Integer(410); _sage_const_928 = Integer(928); _sage_const_230 = Integer(230); _sage_const_465 = Integer(465); _sage_const_568 = Integer(568); _sage_const_687 = Integer(687); _sage_const_284 = Integer(284); _sage_const_794 = Integer(794); _sage_const_606 = Integer(606); _sage_const_705 = Integer(705); _sage_const_602 = Integer(602); _sage_const_442 = Integer(442); _sage_const_523 = Integer(523); _sage_const_260 = Integer(260); _sage_const_530 = Integer(530); _sage_const_796 = Integer(796); _sage_const_443 = Integer(443); _sage_const_902 = Integer(902); _sage_const_210 = Integer(210); _sage_const_785 = Integer(785); _sage_const_440 = Integer(440); _sage_const_572 = Integer(572); _sage_const_268 = Integer(268); _sage_const_217 = Integer(217); _sage_const_866 = Integer(866); _sage_const_778 = Integer(778); _sage_const_923 = Integer(923); _sage_const_197 = Integer(197); _sage_const_446 = Integer(446); _sage_const_202 = Integer(202); _sage_const_353 = Integer(353); _sage_const_852 = Integer(852); _sage_const_1 = Integer(1); _sage_const_0 = Integer(0)
Zx = ZZ['x']; (x,) = Zx._first_ngens(1)
n = _sage_const_109 
q = _sage_const_2048 
p = _sage_const_3 

pub_key = _sage_const_510 *x ** _sage_const_108  - _sage_const_840 *x ** _sage_const_107  - _sage_const_926 *x ** _sage_const_106  - _sage_const_717 *x ** _sage_const_105  - _sage_const_374 *x ** _sage_const_104  - _sage_const_986 *x ** _sage_const_103  + _sage_const_488 *x ** _sage_const_102  + _sage_const_119 *x ** _sage_const_101  - _sage_const_247 *x ** _sage_const_100  + _sage_const_34 *x ** _sage_const_99  + _sage_const_751 *x ** _sage_const_98  - _sage_const_44 *x ** _sage_const_97  - _sage_const_257 *x ** _sage_const_96  - _sage_const_749 *x ** _sage_const_95  + _sage_const_648 *x ** _sage_const_94  - _sage_const_280 *x ** _sage_const_93  - _sage_const_585 *x ** _sage_const_92  - _sage_const_347 *x ** _sage_const_91  + _sage_const_357 *x ** _sage_const_90  - _sage_const_451 *x ** _sage_const_89  - _sage_const_15 *x ** _sage_const_88  + _sage_const_638 *x ** _sage_const_87  - _sage_const_624 *x ** _sage_const_86  - _sage_const_458 *x ** _sage_const_85  + _sage_const_216 *x ** _sage_const_84  + _sage_const_36 *x ** _sage_const_83  - _sage_const_199 *x ** _sage_const_82  - _sage_const_655 *x ** _sage_const_81  + _sage_const_258 *x ** _sage_const_80  + _sage_const_845 *x ** _sage_const_79  + _sage_const_490 *x ** _sage_const_78  - _sage_const_272 *x ** _sage_const_77  + _sage_const_279 *x ** _sage_const_76  + _sage_const_101 *x ** _sage_const_75  - _sage_const_580 *x ** _sage_const_74  - _sage_const_461 *x ** _sage_const_73  - _sage_const_614 *x ** _sage_const_72  - _sage_const_171 *x ** _sage_const_71  - _sage_const_1012 *x ** _sage_const_70  + _sage_const_71 *x ** _sage_const_69  - _sage_const_579 *x ** _sage_const_68  + _sage_const_290 *x ** _sage_const_67  + _sage_const_597 *x ** _sage_const_66  + _sage_const_841 *x ** _sage_const_65  + _sage_const_35 *x ** _sage_const_64  - _sage_const_545 *x ** _sage_const_63  + _sage_const_575 *x ** _sage_const_62  - _sage_const_665 *x ** _sage_const_61  + _sage_const_304 *x ** _sage_const_60  - _sage_const_900 *x ** _sage_const_59  + _sage_const_428 *x ** _sage_const_58  - _sage_const_992 *x ** _sage_const_57  - _sage_const_241 *x ** _sage_const_56  + _sage_const_953 *x ** _sage_const_55  - _sage_const_784 *x ** _sage_const_54  - _sage_const_730 *x ** _sage_const_53  - _sage_const_317 *x ** _sage_const_52  + _sage_const_108 *x ** _sage_const_51  + _sage_const_180 *x ** _sage_const_50  - _sage_const_881 *x ** _sage_const_49  - _sage_const_943 *x ** _sage_const_48  + _sage_const_413 *x ** _sage_const_47  - _sage_const_898 *x ** _sage_const_46  + _sage_const_453 *x ** _sage_const_45  - _sage_const_407 *x ** _sage_const_44  + _sage_const_153 *x ** _sage_const_43  - _sage_const_932 *x ** _sage_const_42  + _sage_const_262 *x ** _sage_const_41  + _sage_const_874 *x ** _sage_const_40  - _sage_const_7 *x ** _sage_const_39  - _sage_const_364 *x ** _sage_const_38  + _sage_const_98 *x ** _sage_const_37  - _sage_const_130 *x ** _sage_const_36  + _sage_const_942 *x ** _sage_const_35  - _sage_const_845 *x ** _sage_const_34  - _sage_const_890 *x ** _sage_const_33  + _sage_const_558 *x ** _sage_const_32  - _sage_const_791 *x ** _sage_const_31  - _sage_const_654 *x ** _sage_const_30  - _sage_const_733 *x ** _sage_const_29  - _sage_const_171  * x ** _sage_const_28  - _sage_const_182 *x ** _sage_const_27  + _sage_const_644 *x ** _sage_const_26  - _sage_const_18 *x ** _sage_const_25  + _sage_const_776 *x ** _sage_const_24  + _sage_const_845 *x ** _sage_const_23  - _sage_const_675 *x ** _sage_const_22  - _sage_const_741 *x ** _sage_const_21  - _sage_const_352 *x ** _sage_const_20  - _sage_const_143 *x ** _sage_const_19  - _sage_const_351 *x ** _sage_const_18  - _sage_const_158 *x ** _sage_const_17  + _sage_const_671 *x ** _sage_const_16  + _sage_const_609 *x ** _sage_const_15  - _sage_const_34 *x ** _sage_const_14  + _sage_const_811 *x ** _sage_const_13  - _sage_const_674 *x ** _sage_const_12  + _sage_const_595 *x ** _sage_const_11  - _sage_const_1005 *x ** _sage_const_10  + _sage_const_855 *x ** _sage_const_9  + _sage_const_831 *x ** _sage_const_8  + _sage_const_768 *x ** _sage_const_7  + _sage_const_133 *x ** _sage_const_6  - _sage_const_436 *x ** _sage_const_5  + _sage_const_1016  * x ** _sage_const_4  + _sage_const_403 *x ** _sage_const_3  + _sage_const_904 *x ** _sage_const_2  + _sage_const_874 *x + _sage_const_248 
e = -_sage_const_453 *x ** _sage_const_108  - _sage_const_304 *x ** _sage_const_107  - _sage_const_380 *x ** _sage_const_106  - _sage_const_7 *x ** _sage_const_105  - _sage_const_657 *x ** _sage_const_104  - _sage_const_988 *x ** _sage_const_103  + _sage_const_219 *x ** _sage_const_102  - _sage_const_167 *x ** _sage_const_101  - _sage_const_473 *x ** _sage_const_100  + _sage_const_63 *x ** _sage_const_99  - _sage_const_60 *x ** _sage_const_98  + _sage_const_1014 *x ** _sage_const_97  - _sage_const_874 *x ** _sage_const_96  - _sage_const_846 *x ** _sage_const_95  + _sage_const_604 *x ** _sage_const_94  - _sage_const_649 *x ** _sage_const_93  + _sage_const_18 *x ** _sage_const_92  - _sage_const_458 *x ** _sage_const_91  + _sage_const_689 *x ** _sage_const_90  + _sage_const_80 *x ** _sage_const_89  - _sage_const_439 *x ** _sage_const_88  + _sage_const_968 *x ** _sage_const_87  - _sage_const_834 *x ** _sage_const_86  - _sage_const_967 *x ** _sage_const_85  - _sage_const_784 *x ** _sage_const_84  + _sage_const_496 *x ** _sage_const_83  - _sage_const_883 *x ** _sage_const_82  + _sage_const_971 *x ** _sage_const_81  - _sage_const_242 *x ** _sage_const_80  + _sage_const_956 *x ** _sage_const_79  - _sage_const_832 *x ** _sage_const_78  - _sage_const_587 *x ** _sage_const_77  + _sage_const_525 *x ** _sage_const_76  + _sage_const_87 *x ** _sage_const_75  + _sage_const_464 *x ** _sage_const_74  + _sage_const_661 *x ** _sage_const_73  - _sage_const_36 *x ** _sage_const_72  - _sage_const_14 *x ** _sage_const_71  + _sage_const_940 *x ** _sage_const_70  - _sage_const_16 *x ** _sage_const_69  - _sage_const_277 *x ** _sage_const_68  + _sage_const_899 *x ** _sage_const_67  - _sage_const_390 *x ** _sage_const_66  + _sage_const_441 *x ** _sage_const_65  + _sage_const_246 *x ** _sage_const_64  + _sage_const_267 *x ** _sage_const_63  - _sage_const_395 *x ** _sage_const_62  + _sage_const_185 *x ** _sage_const_61  + _sage_const_221 *x ** _sage_const_60  + _sage_const_466 *x ** _sage_const_59  + _sage_const_249 *x ** _sage_const_58  + _sage_const_813 *x ** _sage_const_57  + _sage_const_116 *x ** _sage_const_56  - _sage_const_100  * x ** _sage_const_55  + _sage_const_109 *x ** _sage_const_54  + _sage_const_579 *x ** _sage_const_53  + _sage_const_151 *x ** _sage_const_52  + _sage_const_194 *x ** _sage_const_51  + _sage_const_364 *x ** _sage_const_50  - _sage_const_413 *x ** _sage_const_49  + _sage_const_614 *x ** _sage_const_48  + _sage_const_367 *x ** _sage_const_47  + _sage_const_758 *x ** _sage_const_46  + _sage_const_460 *x ** _sage_const_45  + _sage_const_162 *x ** _sage_const_44  + _sage_const_837 *x ** _sage_const_43  + _sage_const_903 *x ** _sage_const_42  + _sage_const_896 *x ** _sage_const_41  - _sage_const_747 *x ** _sage_const_40  + _sage_const_410 *x ** _sage_const_39  - _sage_const_928 *x ** _sage_const_38  - _sage_const_230 *x ** _sage_const_37  + _sage_const_465 *x ** _sage_const_36  - _sage_const_496 *x ** _sage_const_35  - _sage_const_568 *x ** _sage_const_34  + _sage_const_30 *x ** _sage_const_33  - _sage_const_158 *x ** _sage_const_32  + _sage_const_687 *x ** _sage_const_31  - _sage_const_284 *x ** _sage_const_30  + _sage_const_794 *x ** _sage_const_29  - _sage_const_606  * x ** _sage_const_28  + _sage_const_705 *x ** _sage_const_27  - _sage_const_37 *x ** _sage_const_26  + _sage_const_926 *x ** _sage_const_25  - _sage_const_602 *x ** _sage_const_24  - _sage_const_442 *x ** _sage_const_23  - _sage_const_523 *x ** _sage_const_22  - _sage_const_260 *x ** _sage_const_21  + _sage_const_530 *x ** _sage_const_20  - _sage_const_796 *x ** _sage_const_19  + _sage_const_443 *x ** _sage_const_18  + _sage_const_902 *x ** _sage_const_17  - _sage_const_210 *x ** _sage_const_16  + _sage_const_926 *x ** _sage_const_15  + _sage_const_785 *x ** _sage_const_14  + _sage_const_440 *x ** _sage_const_13  - _sage_const_572 *x ** _sage_const_12  - _sage_const_268 *x ** _sage_const_11  - _sage_const_217 *x ** _sage_const_10  + _sage_const_26 *x ** _sage_const_9  + _sage_const_866 *x ** _sage_const_8  + _sage_const_19 *x ** _sage_const_7  + _sage_const_778 *x ** _sage_const_6  + _sage_const_923 *x ** _sage_const_5  - _sage_const_197  * x ** _sage_const_4  - _sage_const_446 *x ** _sage_const_3  - _sage_const_202 *x ** _sage_const_2  - _sage_const_353 *x - _sage_const_852 

pub_key_coeffs = pub_key.coefficients()

def mul(f, g):
    return (f * g) % (x ** n-_sage_const_1 )

def bal_mod(f, q):
    g = list(((f[i] + q//_sage_const_2 ) % q) - q//_sage_const_2  for i in range(n))
    return Zx(g)

def inv_mod_prime(f, p):
    T = Zx.change_ring(Integers(p)).quotient(x ** n-_sage_const_1 )
    return Zx(lift(_sage_const_1  / T(f)))

M_h = Matrix(n*_sage_const_2 , n*_sage_const_2 , _sage_const_0 )
for i in range(n):
    M_h[i, i], M_h[n+i, n+i] = _sage_const_1 , q
    for j in range(n):
        M_h[i, n+j] = pub_key_coeffs[j]
    pub_key_coeffs.insert(_sage_const_0 , pub_key_coeffs.pop())

M_r = M_h.BKZ(block_size=_sage_const_24 )
t = [i for i in M_r[_sage_const_0 ]]
f, g = Zx(t[:n]), Zx(t[n:])
fp = inv_mod_prime(f, p)
a = bal_mod(mul(f, e), q)
m = bal_mod(mul(fp, a), p)
for k in range(_sage_const_8 ):
    flag = k*"0"+"".join([str(i) for i in m.list()])
    flag += (_sage_const_8 -len(flag) % _sage_const_8 )*"0"
    temp = ""
    for i in range(len(flag)//_sage_const_8 ):
        temp += chr(int(flag[i*_sage_const_8 :i*_sage_const_8 +_sage_const_8 ], _sage_const_2 ))
    print(temp)

