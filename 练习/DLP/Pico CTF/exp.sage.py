

# This file was *autogenerated* from the file exp.sage
from sage.all_cmdline import *   # import sage library

_sage_const_93556643250795678718734474880013829509320385402690660619699653921022012489089 = Integer(93556643250795678718734474880013829509320385402690660619699653921022012489089); _sage_const_66001598144012865876674115570268990806314506711104521036747533612798434904785 = Integer(66001598144012865876674115570268990806314506711104521036747533612798434904785); _sage_const_25255205054024371783896605039267101837972419055969636393425590261926131199030 = Integer(25255205054024371783896605039267101837972419055969636393425590261926131199030); _sage_const_56027910981442853390816693056740903416379421186644480759538594137486160388926 = Integer(56027910981442853390816693056740903416379421186644480759538594137486160388926); _sage_const_65533262933617146434438829354623658858649726233622196512439589744498050226926 = Integer(65533262933617146434438829354623658858649726233622196512439589744498050226926); _sage_const_61124499720410964164289905006830679547191538609778446060514645905829507254103 = Integer(61124499720410964164289905006830679547191538609778446060514645905829507254103); _sage_const_2595146854028317060979753545310334521407008629091560515441729386088057610440 = Integer(2595146854028317060979753545310334521407008629091560515441729386088057610440); _sage_const_2 = Integer(2); _sage_const_1 = Integer(1); _sage_const_4 = Integer(4); _sage_const_129 = Integer(129); _sage_const_224 = Integer(224); _sage_const_5729 = Integer(5729); _sage_const_13993 = Integer(13993); _sage_const_1730599 = Integer(1730599); _sage_const_3 = Integer(3); _sage_const_5 = Integer(5); _sage_const_7 = Integer(7); _sage_const_137 = Integer(137); _sage_const_593 = Integer(593); _sage_const_24337 = Integer(24337); _sage_const_25589 = Integer(25589); _sage_const_3637793 = Integer(3637793); _sage_const_77300604515314208997780 = Integer(77300604515314208997780); _sage_const_3117625141812019604914 = Integer(3117625141812019604914); _sage_const_1978990 = Integer(1978990); _sage_const_200 = Integer(200)
from tqdm import tqdm

M = _sage_const_93556643250795678718734474880013829509320385402690660619699653921022012489089 
A = _sage_const_66001598144012865876674115570268990806314506711104521036747533612798434904785 
B = _sage_const_25255205054024371783896605039267101837972419055969636393425590261926131199030 
P = (_sage_const_56027910981442853390816693056740903416379421186644480759538594137486160388926 , _sage_const_65533262933617146434438829354623658858649726233622196512439589744498050226926 )
Q = (_sage_const_61124499720410964164289905006830679547191538609778446060514645905829507254103 , _sage_const_2595146854028317060979753545310334521407008629091560515441729386088057610440 )
F = FiniteField(M)
E = EllipticCurve(F,[A,B])
P = E.point(P)
Q = E.point(Q)
print(factor(E.order()))

# pri = [4,3,5,7,137,593,24337,25589,3637793,5733569,106831998530025000830453,1975901744727669147699767]
# dlogs = []
# for fac in pri:
#     t = int(P.order()) // int(fac)
#     dlog = discrete_log(t*Q,t*P,operation="+")
#     dlogs += [dlog]
#     print("factor: "+str(fac)+", Discrete Log: "+str(dlog)) #calculates discrete logarithm for each prime order
#     print(dlogs)
    
# log = [2, 1, 4, 1, 129, 224, 5729, 13993, 1730599, 4590572]
# pri = [4,3,5,7,137,593,24337,25589,3637793,5733569]
# 1978990
# 4590572
log = [_sage_const_2 , _sage_const_1 , _sage_const_4 , _sage_const_1 , _sage_const_129 , _sage_const_224 , _sage_const_5729 , _sage_const_13993 , _sage_const_1730599 ]
pri = [_sage_const_4 ,_sage_const_3 ,_sage_const_5 ,_sage_const_7 ,_sage_const_137 ,_sage_const_593 ,_sage_const_24337 ,_sage_const_25589 ,_sage_const_3637793 ]
# 77300604515314208997780
mod = _sage_const_77300604515314208997780 
print(crt(log,pri))
x=  _sage_const_3117625141812019604914 
# 400000000000000000000000000000
# 152977126447386808276536247114 
S =x*P 
t = mod*P
for i in tqdm( range(_sage_const_1978990 +_sage_const_200 )):
    S+=t
    if(S==Q):
        print(i)

