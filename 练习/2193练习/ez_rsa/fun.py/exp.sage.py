

# This file was *autogenerated* from the file /mnt/c/Users/16953/Desktop/ez_rsa/fun.py/exp.sage
from sage.all_cmdline import *   # import sage library

_sage_const_649100137910118847061947459521880702864440706961657758407438069629312299332160030304147283355559579458325360985207483857980671374215107435779781377741826289762948159287912657510781398695841965658237655906518141554022239051595782020665567527935490931934943519194150459858869041645825517891140579222410421586130743372140635369635570412855524105423723705071498852807786703198280963794743715439993526532322991472794648280220967951485545285257016004997864173288038317512906074215907949570764320039354061494877517902748654607329920395024265980979435015415317815044737273418739856407162796687796439265167812107167137985803394130927462768903067359900928036068384465298798078074162255409251345616174317007542444043058251382532680145197573798021409379408286887446385609921768170134077468418449209706369997271766220838163502466267295642503571215950031073836231782984054748574392322984691591755694458901458317532502348047427112530466544430702487388066226163893896955660881721476033198148483092103302161496396653721839365242293643367698223526798150709663895230407220923980057001539235782570535714136621523727452003710734732922389316963717936954978555494182131665786129334109885708803335070840200042119524598950408594383339445098913708671496017851 = Integer(649100137910118847061947459521880702864440706961657758407438069629312299332160030304147283355559579458325360985207483857980671374215107435779781377741826289762948159287912657510781398695841965658237655906518141554022239051595782020665567527935490931934943519194150459858869041645825517891140579222410421586130743372140635369635570412855524105423723705071498852807786703198280963794743715439993526532322991472794648280220967951485545285257016004997864173288038317512906074215907949570764320039354061494877517902748654607329920395024265980979435015415317815044737273418739856407162796687796439265167812107167137985803394130927462768903067359900928036068384465298798078074162255409251345616174317007542444043058251382532680145197573798021409379408286887446385609921768170134077468418449209706369997271766220838163502466267295642503571215950031073836231782984054748574392322984691591755694458901458317532502348047427112530466544430702487388066226163893896955660881721476033198148483092103302161496396653721839365242293643367698223526798150709663895230407220923980057001539235782570535714136621523727452003710734732922389316963717936954978555494182131665786129334109885708803335070840200042119524598950408594383339445098913708671496017851); _sage_const_25477443708310275590813822093277840959590449628456587495998982834887076862470763941566169118117866228810753171330333761080154390943514923718034554207590332079948411751917483570428816315243058323724429212759059123093284690102707866013488026596888642449607093239969400346273442026443397397724941690144988505390657639311372383489080966383751589142991337113717815812411857047065844389572583677586717135553198612877442410119983734119795492426844785154483034558623680819609239151812298582760923726928564367913604530499820329026314519474404907121455181829252165159075247143992531857400561697200368303461361270013644996920725 = Integer(25477443708310275590813822093277840959590449628456587495998982834887076862470763941566169118117866228810753171330333761080154390943514923718034554207590332079948411751917483570428816315243058323724429212759059123093284690102707866013488026596888642449607093239969400346273442026443397397724941690144988505390657639311372383489080966383751589142991337113717815812411857047065844389572583677586717135553198612877442410119983734119795492426844785154483034558623680819609239151812298582760923726928564367913604530499820329026314519474404907121455181829252165159075247143992531857400561697200368303461361270013644996920725); _sage_const_2 = Integer(2); _sage_const_600 = Integer(600); _sage_const_2048 = Integer(2048); _sage_const_0p4 = RealNumber('0.4'); _sage_const_0 = Integer(0); _sage_const_25477443708310275590813822093277840959590449628456587495998982834887076862470763941566169118117866228810753171330333761080154390943514923718034554207590332079948411751917483570428816315243058323724429212759059123093284690102707866013488026596888642449607093239969400346273442026443397397724941690144988505390657639311372383489080966383751589142991337113717815812411857047065844389572583677586717135553198612877442410119983734119795492426844785154483034558623682166268812908562771261604857151766121592950531547568420537575435293430130306788059993979503725920265071100128024537637239070259162053972816467565614734152291 = Integer(25477443708310275590813822093277840959590449628456587495998982834887076862470763941566169118117866228810753171330333761080154390943514923718034554207590332079948411751917483570428816315243058323724429212759059123093284690102707866013488026596888642449607093239969400346273442026443397397724941690144988505390657639311372383489080966383751589142991337113717815812411857047065844389572583677586717135553198612877442410119983734119795492426844785154483034558623682166268812908562771261604857151766121592950531547568420537575435293430130306788059993979503725920265071100128024537637239070259162053972816467565614734152291); _sage_const_1 = Integer(1); _sage_const_999 = Integer(999); _sage_const_20210708 = Integer(20210708)#! /usr/bin/sage
import gmpy2 
from hashlib import *
from Crypto.Util.number import *
from sage.all import *

n = int(_sage_const_649100137910118847061947459521880702864440706961657758407438069629312299332160030304147283355559579458325360985207483857980671374215107435779781377741826289762948159287912657510781398695841965658237655906518141554022239051595782020665567527935490931934943519194150459858869041645825517891140579222410421586130743372140635369635570412855524105423723705071498852807786703198280963794743715439993526532322991472794648280220967951485545285257016004997864173288038317512906074215907949570764320039354061494877517902748654607329920395024265980979435015415317815044737273418739856407162796687796439265167812107167137985803394130927462768903067359900928036068384465298798078074162255409251345616174317007542444043058251382532680145197573798021409379408286887446385609921768170134077468418449209706369997271766220838163502466267295642503571215950031073836231782984054748574392322984691591755694458901458317532502348047427112530466544430702487388066226163893896955660881721476033198148483092103302161496396653721839365242293643367698223526798150709663895230407220923980057001539235782570535714136621523727452003710734732922389316963717936954978555494182131665786129334109885708803335070840200042119524598950408594383339445098913708671496017851 )

p4 = _sage_const_25477443708310275590813822093277840959590449628456587495998982834887076862470763941566169118117866228810753171330333761080154390943514923718034554207590332079948411751917483570428816315243058323724429212759059123093284690102707866013488026596888642449607093239969400346273442026443397397724941690144988505390657639311372383489080966383751589142991337113717815812411857047065844389572583677586717135553198612877442410119983734119795492426844785154483034558623680819609239151812298582760923726928564367913604530499820329026314519474404907121455181829252165159075247143992531857400561697200368303461361270013644996920725 
p4 = p4-(p4%_sage_const_2 **_sage_const_600 )
p4 = p4>>_sage_const_600 

pbits = _sage_const_2048 
kbits = pbits - p4.nbits()
print(p4.nbits())
p4 = p4 << kbits
PR = PolynomialRing(Zmod(n), names=('x',)); (x,) = PR._first_ngens(1)
f = x + p4
roots = f.small_roots(X=_sage_const_2 **kbits, beta=_sage_const_0p4 )
print((roots[_sage_const_0 ]+p4))
#  
# p = 25477443708310275590813822093277840959590449628456587495998982834887076862470763941566169118117866228810753171330333761080154390943514923718034554207590332079948411751917483570428816315243058323724429212759059123093284690102707866013488026596888642449607093239969400346273442026443397397724941690144988505390657639311372383489080966383751589142991337113717815812411857047065844389572583677586717135553198612877442410119983734119795492426844785154483034558623682166268812908562771261604857151766121592950531547568420537575435293430130306788059993979503725920265071100128024537637239070259162053972816467565614734152291

N = _sage_const_649100137910118847061947459521880702864440706961657758407438069629312299332160030304147283355559579458325360985207483857980671374215107435779781377741826289762948159287912657510781398695841965658237655906518141554022239051595782020665567527935490931934943519194150459858869041645825517891140579222410421586130743372140635369635570412855524105423723705071498852807786703198280963794743715439993526532322991472794648280220967951485545285257016004997864173288038317512906074215907949570764320039354061494877517902748654607329920395024265980979435015415317815044737273418739856407162796687796439265167812107167137985803394130927462768903067359900928036068384465298798078074162255409251345616174317007542444043058251382532680145197573798021409379408286887446385609921768170134077468418449209706369997271766220838163502466267295642503571215950031073836231782984054748574392322984691591755694458901458317532502348047427112530466544430702487388066226163893896955660881721476033198148483092103302161496396653721839365242293643367698223526798150709663895230407220923980057001539235782570535714136621523727452003710734732922389316963717936954978555494182131665786129334109885708803335070840200042119524598950408594383339445098913708671496017851 
p = _sage_const_25477443708310275590813822093277840959590449628456587495998982834887076862470763941566169118117866228810753171330333761080154390943514923718034554207590332079948411751917483570428816315243058323724429212759059123093284690102707866013488026596888642449607093239969400346273442026443397397724941690144988505390657639311372383489080966383751589142991337113717815812411857047065844389572583677586717135553198612877442410119983734119795492426844785154483034558623682166268812908562771261604857151766121592950531547568420537575435293430130306788059993979503725920265071100128024537637239070259162053972816467565614734152291 
q = N//p

phi = (p-_sage_const_1 )*(q-_sage_const_1 )
t=pow(_sage_const_2 ,N//_sage_const_999 -_sage_const_20210708 ,phi)
m=pow(_sage_const_2 ,t,N)

flag="flag{"+md5(long_to_bytes(m)).hexdigest()+"}"
print(flag)

